<!doctype html><html lang=en class=no-js> <head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta http-equiv=x-ua-compatible content="ie=edge"><link href=https://ruihan.org/research/tfidf-score/notes/ rel=canonical><meta name=lang:clipboard.copy content="Copy to clipboard"><meta name=lang:clipboard.copied content="Copied to clipboard"><meta name=lang:search.language content=en><meta name=lang:search.pipeline.stopwords content=True><meta name=lang:search.pipeline.trimmer content=True><meta name=lang:search.result.none content="No matching documents"><meta name=lang:search.result.one content="1 matching document"><meta name=lang:search.result.other content="# matching documents"><meta name=lang:search.tokenizer content=[\s\-]+><link rel="shortcut icon" href=../../../assets/images/favicon.png><meta name=generator content="mkdocs-1.1, mkdocs-material-4.6.3"><title>TF-IDF for Information Retrieval - RUIHAN.ORG</title><link rel=stylesheet href=../../../assets/stylesheets/application.adb8469c.css><link rel=stylesheet href=../../../assets/stylesheets/application-palette.a8b3c06d.css><meta name=theme-color content><script src=../../../assets/javascripts/modernizr.86422ebf.js></script><link href=https://fonts.gstatic.com rel=preconnect crossorigin><link rel=stylesheet href="https://fonts.googleapis.com/css?family=Roboto:300,400,400i,700%7CRoboto+Mono&display=fallback"><style>body,input{font-family:"Roboto","Helvetica Neue",Helvetica,Arial,sans-serif}code,kbd,pre{font-family:"Roboto Mono","Courier New",Courier,monospace}</style><link rel=stylesheet href=../../../assets/fonts/material-icons.css></head> <body dir=ltr data-md-color-primary=black data-md-color-accent=black> <svg class=md-svg> <defs> <svg xmlns=http://www.w3.org/2000/svg width=416 height=448 viewbox="0 0 416 448" id=__github><path fill=currentColor d="M160 304q0 10-3.125 20.5t-10.75 19T128 352t-18.125-8.5-10.75-19T96 304t3.125-20.5 10.75-19T128 256t18.125 8.5 10.75 19T160 304zm160 0q0 10-3.125 20.5t-10.75 19T288 352t-18.125-8.5-10.75-19T256 304t3.125-20.5 10.75-19T288 256t18.125 8.5 10.75 19T320 304zm40 0q0-30-17.25-51T296 232q-10.25 0-48.75 5.25Q229.5 240 208 240t-39.25-2.75Q130.75 232 120 232q-29.5 0-46.75 21T56 304q0 22 8 38.375t20.25 25.75 30.5 15 35 7.375 37.25 1.75h42q20.5 0 37.25-1.75t35-7.375 30.5-15 20.25-25.75T360 304zm56-44q0 51.75-15.25 82.75-9.5 19.25-26.375 33.25t-35.25 21.5-42.5 11.875-42.875 5.5T212 416q-19.5 0-35.5-.75t-36.875-3.125-38.125-7.5-34.25-12.875T37 371.5t-21.5-28.75Q0 312 0 260q0-59.25 34-99-6.75-20.5-6.75-42.5 0-29 12.75-54.5 27 0 47.5 9.875t47.25 30.875Q171.5 96 212 96q37 0 70 8 26.25-20.5 46.75-30.25T376 64q12.75 25.5 12.75 54.5 0 21.75-6.75 42 34 40 34 99.5z"/></svg> </defs> </svg> <input class=md-toggle data-md-toggle=drawer type=checkbox id=__drawer autocomplete=off> <input class=md-toggle data-md-toggle=search type=checkbox id=__search autocomplete=off> <label class=md-overlay data-md-component=overlay for=__drawer></label> <a href=#tf-idf-and-scoring-for-information-retrieval tabindex=0 class=md-skip> Skip to content </a> <header class=md-header data-md-component=header> <nav class="md-header-nav md-grid"> <div class=md-flex> <div class="md-flex__cell md-flex__cell--shrink"> <a href=https://ruihan.org title=RUIHAN.ORG aria-label=RUIHAN.ORG class="md-header-nav__button md-logo"> <i class=md-icon></i> </a> </div> <div class="md-flex__cell md-flex__cell--shrink"> <label class="md-icon md-icon--menu md-header-nav__button" for=__drawer></label> </div> <div class="md-flex__cell md-flex__cell--stretch"> <div class="md-flex__ellipsis md-header-nav__title" data-md-component=title> <span class=md-header-nav__topic> RUIHAN.ORG </span> <span class=md-header-nav__topic> TF-IDF for Information Retrieval </span> </div> </div> <div class="md-flex__cell md-flex__cell--shrink"> <label class="md-icon md-icon--search md-header-nav__button" for=__search></label> <div class=md-search data-md-component=search role=dialog> <label class=md-search__overlay for=__search></label> <div class=md-search__inner role=search> <form class=md-search__form name=search> <input type=text class=md-search__input aria-label=search name=query placeholder=Search autocapitalize=off autocorrect=off autocomplete=off spellcheck=false data-md-component=query data-md-state=active> <label class="md-icon md-search__icon" for=__search></label> <button type=reset class="md-icon md-search__icon" data-md-component=reset tabindex=-1> &#xE5CD; </button> </form> <div class=md-search__output> <div class=md-search__scrollwrap data-md-scrollfix> <div class=md-search-result data-md-component=result> <div class=md-search-result__meta> Type to start searching </div> <ol class=md-search-result__list></ol> </div> </div> </div> </div> </div> </div> <div class="md-flex__cell md-flex__cell--shrink"> <div class=md-header-nav__source> <a href=https://github.com/iurnah/ruihan.org title="Go to repository" class=md-source data-md-source=github> <div class=md-source__icon> <svg viewbox="0 0 24 24" width=24 height=24> <use xlink:href=#__github width=24 height=24></use> </svg> </div> <div class=md-source__repository> iurnah/ruihan.org </div> </a> </div> </div> </div> </nav> </header> <div class=md-container> <nav class="md-tabs md-tabs--active" data-md-component=tabs> <div class="md-tabs__inner md-grid"> <ul class=md-tabs__list> <li class=md-tabs__item> <a href=../../../books/ class=md-tabs__link> Books </a> </li> <li class=md-tabs__item> <a href=../../../courses/ class=md-tabs__link> Courses </a> </li> <li class=md-tabs__item> <a href=../../../leetcode/ class=md-tabs__link> Leetcode </a> </li> <li class=md-tabs__item> <a href=../../ class="md-tabs__link md-tabs__link--active"> Research </a> </li> <li class=md-tabs__item> <a href=../../../seedlabs/ class=md-tabs__link> SEED Labs </a> </li> <li class=md-tabs__item> <a href=../../../system-design/ class=md-tabs__link> System Design </a> </li> </ul> </div> </nav> <main class=md-main role=main> <div class="md-main__inner md-grid" data-md-component=container> <div class="md-sidebar md-sidebar--primary" data-md-component=navigation> <div class=md-sidebar__scrollwrap> <div class=md-sidebar__inner> <nav class="md-nav md-nav--primary" data-md-level=0> <label class="md-nav__title md-nav__title--site" for=__drawer> <a href=https://ruihan.org title=RUIHAN.ORG class="md-nav__button md-logo"> <i class=md-icon></i> </a> RUIHAN.ORG </label> <div class=md-nav__source> <a href=https://github.com/iurnah/ruihan.org title="Go to repository" class=md-source data-md-source=github> <div class=md-source__icon> <svg viewbox="0 0 24 24" width=24 height=24> <use xlink:href=#__github width=24 height=24></use> </svg> </div> <div class=md-source__repository> iurnah/ruihan.org </div> </a> </div> <ul class=md-nav__list data-md-scrollfix> <li class="md-nav__item md-nav__item--nested"> <input class="md-toggle md-nav__toggle" data-md-toggle=nav-1 type=checkbox id=nav-1> <label class=md-nav__link for=nav-1> Books </label> <nav class=md-nav data-md-component=collapsible data-md-level=1> <label class=md-nav__title for=nav-1> Books </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../books/ title=Index class=md-nav__link> Index </a> </li> <li class=md-nav__item> <a href=../../../books/accelerated-cpp/notes/ title="Accelerated C++" class=md-nav__link> Accelerated C++ </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-toggle md-nav__toggle" data-md-toggle=nav-2 type=checkbox id=nav-2> <label class=md-nav__link for=nav-2> Courses </label> <nav class=md-nav data-md-component=collapsible data-md-level=1> <label class=md-nav__title for=nav-2> Courses </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../courses/ title=Index class=md-nav__link> Index </a> </li> <li class=md-nav__item> <a href=../../../courses/stanford-machine-learning/notes.md title="Stanford Machine Learning" class=md-nav__link> Stanford Machine Learning </a> </li> <li class=md-nav__item> <a href=../../../courses/cs224n/lec-notes/ title="CS224N Lecture Notes" class=md-nav__link> CS224N Lecture Notes </a> </li> <li class=md-nav__item> <a href=../../../courses/cs224n/write-up/ title="CS224N Write-up" class=md-nav__link> CS224N Write-up </a> </li> <li class=md-nav__item> <a href=../../../courses/6.431-probability/notes/ title="6.431 Probability" class=md-nav__link> 6.431 Probability </a> </li> <li class=md-nav__item> <a href=../../../courses/learning-from-data/notes.md title="Learning From Data" class=md-nav__link> Learning From Data </a> </li> <li class=md-nav__item> <a href=../../../courses/9chap-system-design/notes/ title="Nine Chapter System Design" class=md-nav__link> Nine Chapter System Design </a> </li> <li class=md-nav__item> <a href=../../../courses/9chap-dynamic-prog/notes/ title="Nine Chapter Dynamic Programming" class=md-nav__link> Nine Chapter Dynamic Programming </a> </li> <li class=md-nav__item> <a href=../../../courses/func-prog-in-scala/notes/ title="Functional Programming Principles in Scala" class=md-nav__link> Functional Programming Principles in Scala </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-toggle md-nav__toggle" data-md-toggle=nav-3 type=checkbox id=nav-3> <label class=md-nav__link for=nav-3> Leetcode </label> <nav class=md-nav data-md-component=collapsible data-md-level=1> <label class=md-nav__title for=nav-3> Leetcode </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../leetcode/ title=Index class=md-nav__link> Index </a> </li> <li class=md-nav__item> <a href=../../../leetcode/array/notes/ title=Array class=md-nav__link> Array </a> </li> <li class=md-nav__item> <a href=../../../leetcode/backtracking/notes/ title=Backtracking class=md-nav__link> Backtracking </a> </li> <li class=md-nav__item> <a href=../../../leetcode/binary-search/notes/ title="Binary Search" class=md-nav__link> Binary Search </a> </li> <li class=md-nav__item> <a href=../../../leetcode/breadth-first-search/notes/ title="Breadth-First Search (BFS)" class=md-nav__link> Breadth-First Search (BFS) </a> </li> <li class=md-nav__item> <a href=../../../leetcode/depth-first-search/notes/ title="Depth-First Search (DFS)" class=md-nav__link> Depth-First Search (DFS) </a> </li> <li class=md-nav__item> <a href=../../../leetcode/dynamic-programming/notes/ title="Dynamic Programming" class=md-nav__link> Dynamic Programming </a> </li> <li class=md-nav__item> <a href=../../../leetcode/graph/notes/ title=Graph class=md-nav__link> Graph </a> </li> <li class=md-nav__item> <a href=../../../leetcode/heap/notes/ title=Heap class=md-nav__link> Heap </a> </li> <li class=md-nav__item> <a href=../../../leetcode/interval/notes/ title=Interval class=md-nav__link> Interval </a> </li> <li class=md-nav__item> <a href=../../../leetcode/linked-list/notes/ title="Linked List" class=md-nav__link> Linked List </a> </li> <li class=md-nav__item> <a href=../../../leetcode/stack/notes/ title=Stack class=md-nav__link> Stack </a> </li> <li class=md-nav__item> <a href=../../../leetcode/string/notes/ title=String class=md-nav__link> String </a> </li> <li class=md-nav__item> <a href=../../../leetcode/tree/notes/ title=Tree class=md-nav__link> Tree </a> </li> <li class=md-nav__item> <a href=../../../leetcode/trie/notes/ title=Trie class=md-nav__link> Trie </a> </li> <li class=md-nav__item> <a href=../../../leetcode/union-find/notes/ title="Union Find" class=md-nav__link> Union Find </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--active md-nav__item--nested"> <input class="md-toggle md-nav__toggle" data-md-toggle=nav-4 type=checkbox id=nav-4 checked> <label class=md-nav__link for=nav-4> Research </label> <nav class=md-nav data-md-component=collapsible data-md-level=1> <label class=md-nav__title for=nav-4> Research </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../ title=Index class=md-nav__link> Index </a> </li> <li class=md-nav__item> <a href=../../coalition-game/notes/ title="Coalition Game" class=md-nav__link> Coalition Game </a> </li> <li class=md-nav__item> <a href=../../contextual-bandit/notes/ title="Contextual Multi-Armed Bandit" class=md-nav__link> Contextual Multi-Armed Bandit </a> </li> <li class="md-nav__item md-nav__item--active"> <input class="md-toggle md-nav__toggle" data-md-toggle=toc type=checkbox id=__toc> <label class="md-nav__link md-nav__link--active" for=__toc> TF-IDF for Information Retrieval </label> <a href=./ title="TF-IDF for Information Retrieval" class="md-nav__link md-nav__link--active"> TF-IDF for Information Retrieval </a> <nav class="md-nav md-nav--secondary"> <label class=md-nav__title for=__toc>Table of contents</label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=#term-document-incidence-matrices class=md-nav__link> term document incidence matrices </a> </li> <li class=md-nav__item> <a href=#the-inverted-index class=md-nav__link> The inverted index </a> </li> <li class=md-nav__item> <a href=#query-processing class=md-nav__link> Query processing </a> </li> <li class=md-nav__item> <a href=#boolean-query class=md-nav__link> Boolean query </a> </li> <li class=md-nav__item> <a href=#phrase-queries class=md-nav__link> Phrase queries </a> </li> <li class=md-nav__item> <a href=#ranked-retriveval class=md-nav__link> Ranked retriveval </a> </li> <li class=md-nav__item> <a href=#scoring-with-the-jaccard-coefficient class=md-nav__link> Scoring with the Jaccard Coefficient </a> </li> <li class=md-nav__item> <a href=#term-frequency-weighting class=md-nav__link> Term frequency weighting </a> <nav class=md-nav> <ul class=md-nav__list> <li class=md-nav__item> <a href=#log-frequency-weighting class=md-nav__link> Log-frequency weighting </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#inverted-document-frequency-weighting class=md-nav__link> (Inverted) Document frequency weighting </a> </li> <li class=md-nav__item> <a href=#collection-frequency-vs-document-frequency class=md-nav__link> collection frequency vs document frequency </a> </li> <li class=md-nav__item> <a href=#tf-idf-weighting class=md-nav__link> TF-IDF weighting </a> </li> <li class=md-nav__item> <a href=#vector-space-model class=md-nav__link> Vector Space Model </a> </li> <li class=md-nav__item> <a href=#application-for-https-request-embedding class=md-nav__link> application for https request embedding </a> </li> <li class=md-nav__item> <a href=#problem class=md-nav__link> problem </a> </li> <li class=md-nav__item> <a href=#solution class=md-nav__link> Solution </a> <nav class=md-nav> <ul class=md-nav__list> <li class=md-nav__item> <a href=#calculate-tf-idf-for-individual-header-fields class=md-nav__link> calculate tf-idf for individual header fields </a> </li> <li class=md-nav__item> <a href=#tokenize-all-request-facets class=md-nav__link> tokenize all request facets </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#intuitions class=md-nav__link> Intuitions </a> </li> <li class=md-nav__item> <a href=#practical-consideration class=md-nav__link> Practical consideration </a> </li> </ul> </nav> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-toggle md-nav__toggle" data-md-toggle=nav-5 type=checkbox id=nav-5> <label class=md-nav__link for=nav-5> SEED Labs </label> <nav class=md-nav data-md-component=collapsible data-md-level=1> <label class=md-nav__title for=nav-5> SEED Labs </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../seedlabs/ title=Index class=md-nav__link> Index </a> </li> <li class=md-nav__item> <a href=../../../seedlabs/applied-crypto/notes/ title="Applied Cryptograph Notes" class=md-nav__link> Applied Cryptograph Notes </a> </li> <li class=md-nav__item> <a href=../../../seedlabs/public-key-cryptography-and-pki/notes/ title="Public Key Cryptography and PKI" class=md-nav__link> Public Key Cryptography and PKI </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-toggle md-nav__toggle" data-md-toggle=nav-6 type=checkbox id=nav-6> <label class=md-nav__link for=nav-6> System Design </label> <nav class=md-nav data-md-component=collapsible data-md-level=1> <label class=md-nav__title for=nav-6> System Design </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../system-design/ title=Index class=md-nav__link> Index </a> </li> <li class=md-nav__item> <a href=../../../system-design/concepts/notes/ title="Distributed System Concepts" class=md-nav__link> Distributed System Concepts </a> </li> <li class=md-nav__item> <a href=../../../system-design/patterns/notes/ title="Design Patterns" class=md-nav__link> Design Patterns </a> </li> <li class=md-nav__item> <a href=../../../system-design/problems/tinyurl/notes/ title="How to Design TinyUrl" class=md-nav__link> How to Design TinyUrl </a> </li> <li class=md-nav__item> <a href=../../../system-design/problems/twitter/notes/ title="How to Design Twitter" class=md-nav__link> How to Design Twitter </a> </li> <li class=md-nav__item> <a href=../../../system-design/problems/ticketmaster/notes/ title="How to Design Ticketmaster" class=md-nav__link> How to Design Ticketmaster </a> </li> </ul> </nav> </li> </ul> </nav> </div> </div> </div> <div class="md-sidebar md-sidebar--secondary" data-md-component=toc> <div class=md-sidebar__scrollwrap> <div class=md-sidebar__inner> <nav class="md-nav md-nav--secondary"> <label class=md-nav__title for=__toc>Table of contents</label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=#term-document-incidence-matrices class=md-nav__link> term document incidence matrices </a> </li> <li class=md-nav__item> <a href=#the-inverted-index class=md-nav__link> The inverted index </a> </li> <li class=md-nav__item> <a href=#query-processing class=md-nav__link> Query processing </a> </li> <li class=md-nav__item> <a href=#boolean-query class=md-nav__link> Boolean query </a> </li> <li class=md-nav__item> <a href=#phrase-queries class=md-nav__link> Phrase queries </a> </li> <li class=md-nav__item> <a href=#ranked-retriveval class=md-nav__link> Ranked retriveval </a> </li> <li class=md-nav__item> <a href=#scoring-with-the-jaccard-coefficient class=md-nav__link> Scoring with the Jaccard Coefficient </a> </li> <li class=md-nav__item> <a href=#term-frequency-weighting class=md-nav__link> Term frequency weighting </a> <nav class=md-nav> <ul class=md-nav__list> <li class=md-nav__item> <a href=#log-frequency-weighting class=md-nav__link> Log-frequency weighting </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#inverted-document-frequency-weighting class=md-nav__link> (Inverted) Document frequency weighting </a> </li> <li class=md-nav__item> <a href=#collection-frequency-vs-document-frequency class=md-nav__link> collection frequency vs document frequency </a> </li> <li class=md-nav__item> <a href=#tf-idf-weighting class=md-nav__link> TF-IDF weighting </a> </li> <li class=md-nav__item> <a href=#vector-space-model class=md-nav__link> Vector Space Model </a> </li> <li class=md-nav__item> <a href=#application-for-https-request-embedding class=md-nav__link> application for https request embedding </a> </li> <li class=md-nav__item> <a href=#problem class=md-nav__link> problem </a> </li> <li class=md-nav__item> <a href=#solution class=md-nav__link> Solution </a> <nav class=md-nav> <ul class=md-nav__list> <li class=md-nav__item> <a href=#calculate-tf-idf-for-individual-header-fields class=md-nav__link> calculate tf-idf for individual header fields </a> </li> <li class=md-nav__item> <a href=#tokenize-all-request-facets class=md-nav__link> tokenize all request facets </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#intuitions class=md-nav__link> Intuitions </a> </li> <li class=md-nav__item> <a href=#practical-consideration class=md-nav__link> Practical consideration </a> </li> </ul> </nav> </div> </div> </div> <div class=md-content> <article class="md-content__inner md-typeset"> <h1 id=tf-idf-and-scoring-for-information-retrieval>TF-IDF and Scoring for Information Retrieval<a class=headerlink href=#tf-idf-and-scoring-for-information-retrieval title="Permanent link">&para;</a></h1> <ul> <li><a href="https://www.youtube.com/watch?v=e81nC0LO0A8&list=PLaZQkZp6WhWwoDuD6pQCmgVyDbUWl_ZUi&index=2">Youtube Lecture by Dr. Manning</a></li> <li><a href=../06vect.pdf>Book chapter</a></li> <li><a href=../lecture6-tfidf.ppt>tfidf slides</a></li> </ul> <h2 id=term-document-incidence-matrices>term document incidence matrices<a class=headerlink href=#term-document-incidence-matrices title="Permanent link">&para;</a></h2> <p>not practical because of the sparsity.</p> <h2 id=the-inverted-index>The inverted index<a class=headerlink href=#the-inverted-index title="Permanent link">&para;</a></h2> <p>token to document list mapping</p> <p>word -&gt; [doc1, doc2, ...]</p> <p>UA -&gt; [2020-04-01 13:03:23, 2020-04-01 13:03:23]</p> <h2 id=query-processing>Query processing<a class=headerlink href=#query-processing title="Permanent link">&para;</a></h2> <p>If we want to query which document have the phrash "information retrival", we'd like to take the invert index postings list for "information" and "retrival", then find the document that have both word. (by run a merge algorithm on the two postings list)</p> <h2 id=boolean-query>Boolean query<a class=headerlink href=#boolean-query title="Permanent link">&para;</a></h2> <p>Mainly leverage the boolean operation on the list merging algorithm.</p> <h2 id=phrase-queries>Phrase queries<a class=headerlink href=#phrase-queries title="Permanent link">&para;</a></h2> <p>no longer suffice to store <code>&lt;term, doc&gt;</code> entries.</p> <ul> <li>First attempt, biword indexes. treat the two words phrase as a single phrase.</li> <li>For longer phrase queries, we can broken into the boolean query on biword.<ul> <li>false positive, two words not adjacent</li> <li>index blowup due to big dictionary</li> </ul> </li> <li>positional indexes, store the positions of each token occurs at a document.<ul> <li>use a merge algorithm to recursively at the document level.</li> </ul> </li> </ul> <p><img alt="processing a phrase query" src=../fig/phrase-query.png> </p> <h2 id=ranked-retriveval>Ranked retriveval<a class=headerlink href=#ranked-retriveval title="Permanent link">&para;</a></h2> <ul> <li>"How can we rank-order the documents in the collection with respect to a query?"</li> <li>assign a score to each document - say in <code>[0, 1]</code> - to each document.</li> <li>This score measures how well document and query match.</li> <li>We need a way to assigning a score to a query/document pair.</li> <li>The more frequent a term appears in a document, the higher the score for the document.</li> </ul> <h2 id=scoring-with-the-jaccard-coefficient>Scoring with the Jaccard Coefficient<a class=headerlink href=#scoring-with-the-jaccard-coefficient title="Permanent link">&para;</a></h2> <ul> <li>doesn't consider term frequency.</li> <li>wee need a better way of normalizing for length. (compare with cosine similarity)</li> </ul> <h2 id=term-frequency-weighting>Term frequency weighting<a class=headerlink href=#term-frequency-weighting title="Permanent link">&para;</a></h2> <ul> <li>binary vector <span><span class=MathJax_Preview>\in {0, 1}</span><script type=math/tex>\in {0, 1}</script></span></li> <li>count vector</li> <li>bag of words model</li> </ul> <div class="admonition tip"> <p class=admonition-title>Tip</p> <p>We want to use TF when computing query-document match scores, but the relevance does not increase proportionally with term frequency</p> </div> <h3 id=log-frequency-weighting>Log-frequency weighting<a class=headerlink href=#log-frequency-weighting title="Permanent link">&para;</a></h3> <div> <div class=MathJax_Preview> w_{t, d} = \begin{cases} 1 + \log_{10} (tf_{t,d}), &amp; tf_{t,d} \ge 0 \\ 0, &amp; \textrm{otherwise} \end{cases} </div> <script type="math/tex; mode=display">
w_{t, d} =
\begin{cases}
  1 + \log_{10} (tf_{t,d}), & tf_{t,d} \ge 0 \\
  0,  &  \textrm{otherwise}
\end{cases}
</script> </div> <p>Score for a document-query pair: sum over terms in both <span><span class=MathJax_Preview>q</span><script type=math/tex>q</script></span> and <span><span class=MathJax_Preview>d</span><script type=math/tex>d</script></span>:</p> <div> <div class=MathJax_Preview> \textrm{score} = \sum_{t\in q \cap d} (1 + \log_{10} (tf_{t, d})) </div> <script type="math/tex; mode=display">
\textrm{score} = \sum_{t\in q \cap d} (1 + \log_{10} (tf_{t, d}))
</script> </div> <p>The score is <span><span class=MathJax_Preview>0</span><script type=math/tex>0</script></span> if none of the terms is presented in the document.</p> <h2 id=inverted-document-frequency-weighting>(Inverted) Document frequency weighting<a class=headerlink href=#inverted-document-frequency-weighting title="Permanent link">&para;</a></h2> <ul> <li>idea: Rare terms are more informative than frequent terms.</li> <li><span><span class=MathJax_Preview>df_t</span><script type=math/tex>df_t</script></span> is an inverse measure of informativeness of term <span><span class=MathJax_Preview>t</span><script type=math/tex>t</script></span>.</li> <li>There is one idf value for each term <span><span class=MathJax_Preview>t</span><script type=math/tex>t</script></span> in a collection.</li> </ul> <div> <div class=MathJax_Preview> idf_t = \log_{10}(N/df_t) </div> <script type="math/tex; mode=display">
idf_t = \log_{10}(N/df_t)
</script> </div> <p><img alt="IDF example" src=../fig/idf-example.png></p> <div class="admonition question"> <p class=admonition-title>Question</p> <p>Does idf have an effect on ranking for one-term queries, like "iPhone"? The answer is no, but why?</p> </div> <h2 id=collection-frequency-vs-document-frequency>collection frequency vs document frequency<a class=headerlink href=#collection-frequency-vs-document-frequency title="Permanent link">&para;</a></h2> <p><img alt="collection frequency" src=../fig/collection-freq.png></p> <h2 id=tf-idf-weighting>TF-IDF weighting<a class=headerlink href=#tf-idf-weighting title="Permanent link">&para;</a></h2> <div> <div class=MathJax_Preview> \textrm{score}(q, d) = \sum_{t\in q \cap d} tf_{t, d} \times idf_{t} </div> <script type="math/tex; mode=display">
\textrm{score}(q, d) = \sum_{t\in q \cap d} tf_{t, d} \times idf_{t}
</script> </div> <ul> <li>binary vector -&gt; count vector -&gt; weight matrix</li> </ul> <h2 id=vector-space-model>Vector Space Model<a class=headerlink href=#vector-space-model title="Permanent link">&para;</a></h2> <ul> <li>Euclidean distance, not a good option. because different vector length can have large distance</li> </ul> <h2 id=application-for-https-request-embedding>application for https request embedding<a class=headerlink href=#application-for-https-request-embedding title="Permanent link">&para;</a></h2> <p>If we can build a dataset, given a "query", it can efficiently retrive how many relevant "document" are in the past 2 hours? We will be able to tell wether the "query" is mallicious or not.</p> <p>in anti-abuse, we can use the current request as the query, all the reprevious request data that are indexed as the "documents". This will give us a score about the current request. This score can tell us the malliciousness of the request.</p> <h2 id=problem>problem<a class=headerlink href=#problem title="Permanent link">&para;</a></h2> <ul> <li>Current distribution score cannot identify scraping that routates headers.<ul> <li>How to up weight bad requests with certain patterns?</li> </ul> </li> <li>Currently, no good way to block signals with low false positives.<ul> <li>How to use score instead of text pattern matching to reduce false positives?</li> </ul> </li> </ul> <h2 id=solution>Solution<a class=headerlink href=#solution title="Permanent link">&para;</a></h2> <h3 id=calculate-tf-idf-for-individual-header-fields>calculate tf-idf for individual header fields<a class=headerlink href=#calculate-tf-idf-for-individual-header-fields title="Permanent link">&para;</a></h3> <p>This solution models a collection of requests during a window as a document.</p> <p>term frequency = count of each UA, HC, CC, and RF in a time window document frequency = count of how many windows each UA, HC, CC, and RF occurs</p> <p>the window can be a time window or fixed size window. In the fixed size window, instead of divided by hour, we divide by fixed number of requests and treat each collection as a document. This model can also be used for the tokenized solution.</p> <h3 id=tokenize-all-request-facets>tokenize all request facets<a class=headerlink href=#tokenize-all-request-facets title="Permanent link">&para;</a></h3> <p>This solution is to break down the header fields into tokens and use a set of tokens as the query. Compare this to a phrase retrival task.</p> <p>term frequency = count of each token</p> <div class="admonition question"> <p class=admonition-title>Question</p> <p>Can we use the consine similarity to compare two queries? Because the similarirty measure described in the lectures is for query-document pair. Can we compare query-query pair? Whether the TF-IDF embedding can capture enough similarity info and used for clustering?</p> </div> <h2 id=intuitions>Intuitions<a class=headerlink href=#intuitions title="Permanent link">&para;</a></h2> <p>Using TF-IDF, we are able to measure the speed of demage from request possess the similar attributes (belongs to certain attacks). Specifically, given a request in realtime, it can check the current TF, and DF, and calculate the TF-IDF. All these three values are useful for us.</p> <ul> <li>TF - If TF is greater than a threshold setting. We can it is may be a high qps scraping. If TF is moderate or very small, we can check DF.</li> <li>DF - If DF is very large, the "term" maybe common to all sample in the space. If DF streak is not long enough in a series of previous documents. there might be a spike of increase for the term in some window before. If DF is very small, and the TF is large, we detected a spike.</li> </ul> <table> <thead> <tr> <th>#</th> <th>TF</th> <th>DF</th> <th>result</th> <th></th> </tr> </thead> <tbody> <tr> <td>1</td> <td>large</td> <td>small</td> <td>bad</td> <td>v</td> </tr> <tr> <td>2</td> <td>large</td> <td>large</td> <td>bad/good</td> <td>x</td> </tr> <tr> <td>3</td> <td>small</td> <td>large</td> <td>bad/good</td> <td>x</td> </tr> <tr> <td>4</td> <td>small</td> <td>small</td> <td>good</td> <td>x</td> </tr> </tbody> </table> <p>TF and IDF used separately can help to observe bad signals, but they are not enough. We will need to use TF-IDF to help us to enhance our believe about the badness of a request.</p> <p>TF-IDF</p> <h2 id=practical-consideration>Practical consideration<a class=headerlink href=#practical-consideration title="Permanent link">&para;</a></h2> <ul> <li>How to calculation TF-IDF in sliding windows?</li> </ul> <p>title: HTTP requests embedding to score and search bot traffic.</p> </article> </div> </div> </main> <footer class=md-footer> <div class=md-footer-nav> <nav class="md-footer-nav__inner md-grid"> <a href=../../contextual-bandit/notes/ title="Contextual Multi-Armed Bandit" class="md-flex md-footer-nav__link md-footer-nav__link--prev" rel=prev> <div class="md-flex__cell md-flex__cell--shrink"> <i class="md-icon md-icon--arrow-back md-footer-nav__button"></i> </div> <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title"> <span class=md-flex__ellipsis> <span class=md-footer-nav__direction> Previous </span> Contextual Multi-Armed Bandit </span> </div> </a> <a href=../../../seedlabs/ title=Index class="md-flex md-footer-nav__link md-footer-nav__link--next" rel=next> <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title"> <span class=md-flex__ellipsis> <span class=md-footer-nav__direction> Next </span> Index </span> </div> <div class="md-flex__cell md-flex__cell--shrink"> <i class="md-icon md-icon--arrow-forward md-footer-nav__button"></i> </div> </a> </nav> </div> <div class="md-footer-meta md-typeset"> <div class="md-footer-meta__inner md-grid"> <div class=md-footer-copyright> <div class=md-footer-copyright__highlight> Copyright &copy; 2020 Rui Han </div> powered by <a href=https://www.mkdocs.org target=_blank rel=noopener>MkDocs</a> and <a href=https://squidfunk.github.io/mkdocs-material/ target=_blank rel=noopener> Material for MkDocs</a> </div> </div> </div> </footer> </div> <script src=../../../assets/javascripts/application.c33a9706.js></script> <script>app.initialize({version:"1.1",url:{base:"../../.."}})</script> <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.0/MathJax.js?config=TeX-MML-AM_CHTML"></script> </body> </html>